<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The reduced Fisher Information Matrix (FIM) using the SD of RUV as a parameter. — mftot4 • PopED</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">PopED</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/intro-poped.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/andrewhooker/PopED">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>The reduced Fisher Information Matrix (FIM) using the SD of RUV as a parameter.</h1>
    </div>

    
    <p>Compute the reduced FIM using the standard deviation of the residual unexplained variability (RUV) terms as a parameter, 
given specific model(s), parameters, design and methods. 
This computation 
assumes that there is no correlation in the FIM between the fixed and random effects, 
and set these elements in the FIM to zero.
In addition all derivatives in the computation are made 
with respect to the standard deviation of the RUV terms (sqrt(SIGMA) in NONMEM). 
This matches what is done in PFIM, and assumes that the standard deviation of the residual unexplained variation is the estimated parameter
(NOTE: NONMEM estimates the variance of the resudual unexplained variation by default).</p>
    

    <pre><span class='fu'>mftot4</span>(<span class='no'>model_switch</span>, <span class='no'>groupsize</span>, <span class='no'>ni</span>, <span class='no'>xt</span>, <span class='no'>x</span>, <span class='no'>a</span>, <span class='no'>bpop</span>, <span class='no'>d</span>, <span class='no'>sigma</span>, <span class='no'>docc</span>, <span class='no'>poped.db</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>model_switch</dt>
      <dd>A matrix that is the same size as xt, specifying which model each sample belongs to.</dd>
      <dt>groupsize</dt>
      <dd>A vector of the numer of individuals in each group.</dd>
      <dt>ni</dt>
      <dd>A vector of the number of samples in each group.</dd>
      <dt>xt</dt>
      <dd>A matrix of sample times.  Each row is a vector of sample times for a group.</dd>
      <dt>x</dt>
      <dd>A matrix for the discrete design variables.  Each row is a group.</dd>
      <dt>a</dt>
      <dd>A matrix of covariates.  Each row is a group.</dd>
      <dt>bpop</dt>
      <dd>The fixed effects parameter values.  Supplied as a vector.</dd>
      <dt>d</dt>
      <dd>A between subject variability matrix (OMEGA in NONMEM).</dd>
      <dt>sigma</dt>
      <dd>A residual unexplained variability matrix (SIGMA in NONMEM).</dd>
      <dt>docc</dt>
      <dd>A between occasion variability matrix.</dd>
      <dt>poped.db</dt>
      <dd>A PopED database.</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>As a list:</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p>For an easier function to use, please see <code><a href='evaluate.fim.html'>evaluate.fim</a></code>.</p>
    <p>Other FIM: <code><a href='LinMatrixH.html'>LinMatrixH</a></code>,
  <code><a href='LinMatrixLH.html'>LinMatrixLH</a></code>, <code><a href='LinMatrixL_occ.html'>LinMatrixL_occ</a></code>,
  <code><a href='calc_ofv_and_fim.html'>calc_ofv_and_fim</a></code>,
  <code><a href='ed_laplace_ofv.html'>ed_laplace_ofv</a></code>, <code><a href='ed_mftot.html'>ed_mftot</a></code>,
  <code><a href='efficiency.html'>efficiency</a></code>,
  <code><a href='evaluate.e.ofv.fim.html'>evaluate.e.ofv.fim</a></code>,
  <code><a href='evaluate.fim.html'>evaluate.fim</a></code>, <code><a href='gradf_eps.html'>gradf_eps</a></code>,
  <code><a href='mf3.html'>mf3</a></code>, <code><a href='mf5.html'>mf5</a></code>, <code><a href='mf6.html'>mf6</a></code>,
  <code><a href='mf7.html'>mf7</a></code>, <code><a href='mf8.html'>mf8</a></code>,
  <code><a href='mftot0.html'>mftot0</a></code>, <code><a href='mftot1.html'>mftot1</a></code>,
  <code><a href='mftot2.html'>mftot2</a></code>, <code><a href='mftot3.html'>mftot3</a></code>,
  <code><a href='mftot5.html'>mftot5</a></code>, <code><a href='mftot6.html'>mftot6</a></code>,
  <code><a href='mftot7.html'>mftot7</a></code>, <code><a href='mftot.html'>mftot</a></code>,
  <code><a href='mf.html'>mf</a></code>, <code><a href='ofv_criterion.html'>ofv_criterion</a></code>,
  <code><a href='ofv_fim.html'>ofv_fim</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>PopED</span>)

<span class='co'>############# START #################</span>
<span class='co'>## Create PopED database</span>
<span class='co'>## (warfarin model for optimization)</span>
<span class='co'>#####################################</span>

<span class='co'>## Warfarin example from software comparison in:</span>
<span class='co'>## Nyberg et al., "Methods and software tools for design evaluation </span>
<span class='co'>##   for population pharmacokinetics-pharmacodynamics studies", </span>
<span class='co'>##   Br. J. Clin. Pharm., 2014. </span>

<span class='co'>## Optimization using an additive + proportional reidual error  </span>
<span class='co'>## to avoid sample times at very low concentrations (time 0 or very late samples).</span>

<span class='co'>## find the parameters that are needed to define from the structural model</span>
<span class='no'>ff.PK.1.comp.oral.sd.CL</span></div><div class='output co'>#&gt; function(model_switch,xt,parameters,poped.db){
#&gt;   ##-- Model: One comp first order absorption
#&gt;   with(as.list(parameters),{
#&gt;     y=xt
#&gt;     y=(DOSE*Favail*KA/(V*(KA-CL/V)))*(exp(-CL/V*xt)-exp(-KA*xt))
#&gt;     return(list( y= y,poped.db=poped.db))
#&gt;   })
#&gt; }
#&gt; &lt;environment: namespace:PopED&gt;</div><div class='input'>
<span class='co'>## -- parameter definition function </span>
<span class='co'>## -- names match parameters in function ff</span>
<span class='no'>sfg</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>,<span class='no'>a</span>,<span class='no'>bpop</span>,<span class='no'>b</span>,<span class='no'>bocc</span>){
  <span class='no'>parameters</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>CL</span><span class='kw'>=</span><span class='no'>bpop</span>[<span class='fl'>1</span>]*<span class='fu'>exp</span>(<span class='no'>b</span>[<span class='fl'>1</span>]),
               <span class='kw'>V</span><span class='kw'>=</span><span class='no'>bpop</span>[<span class='fl'>2</span>]*<span class='fu'>exp</span>(<span class='no'>b</span>[<span class='fl'>2</span>]),
               <span class='kw'>KA</span><span class='kw'>=</span><span class='no'>bpop</span>[<span class='fl'>3</span>]*<span class='fu'>exp</span>(<span class='no'>b</span>[<span class='fl'>3</span>]),
               <span class='kw'>Favail</span><span class='kw'>=</span><span class='no'>bpop</span>[<span class='fl'>4</span>],
               <span class='kw'>DOSE</span><span class='kw'>=</span><span class='no'>a</span>[<span class='fl'>1</span>])
  <span class='fu'>return</span>(<span class='no'>parameters</span>)
}

<span class='co'>## -- Define initial design  and design space</span>
<span class='no'>poped.db</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='create.poped.database.html'>create.poped.database</a></span>(<span class='kw'>ff_fun</span><span class='kw'>=</span><span class='no'>ff.PK.1.comp.oral.sd.CL</span>,
                                  <span class='kw'>fg_fun</span><span class='kw'>=</span><span class='no'>sfg</span>,
                                  <span class='kw'>fError_fun</span><span class='kw'>=</span><span class='no'>feps.add.prop</span>,
                                  <span class='kw'>bpop</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>CL</span><span class='kw'>=</span><span class='fl'>0.15</span>, <span class='kw'>V</span><span class='kw'>=</span><span class='fl'>8</span>, <span class='kw'>KA</span><span class='kw'>=</span><span class='fl'>1.0</span>, <span class='kw'>Favail</span><span class='kw'>=</span><span class='fl'>1</span>),
                                  <span class='kw'>notfixed_bpop</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>),
                                  <span class='kw'>d</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>CL</span><span class='kw'>=</span><span class='fl'>0.07</span>, <span class='kw'>V</span><span class='kw'>=</span><span class='fl'>0.02</span>, <span class='kw'>KA</span><span class='kw'>=</span><span class='fl'>0.6</span>),
                                  <span class='kw'>sigma</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.01</span>,<span class='fl'>0.25</span>),
                                  <span class='kw'>groupsize</span><span class='kw'>=</span><span class='fl'>32</span>,
                                  <span class='kw'>xt</span><span class='kw'>=</span><span class='fu'>c</span>( <span class='fl'>0.5</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>6</span>,<span class='fl'>24</span>,<span class='fl'>36</span>,<span class='fl'>72</span>,<span class='fl'>120</span>),
                                  <span class='kw'>minxt</span><span class='kw'>=</span><span class='fl'>0.01</span>,
                                  <span class='kw'>maxxt</span><span class='kw'>=</span><span class='fl'>120</span>,
                                  <span class='kw'>a</span><span class='kw'>=</span><span class='fl'>70</span>,
                                  <span class='kw'>mina</span><span class='kw'>=</span><span class='fl'>0.01</span>,
                                  <span class='kw'>maxa</span><span class='kw'>=</span><span class='fl'>100</span>)

<span class='co'>############# END ###################</span>
<span class='co'>## Create PopED database</span>
<span class='co'>## (warfarin model for optimization)</span>
<span class='co'>#####################################</span>


<span class='fu'>mftot4</span>(<span class='kw'>model_switch</span><span class='kw'>=</span><span class='no'>poped.db</span>$<span class='no'>design</span>$<span class='no'>model_switch</span>,
      <span class='kw'>groupsize</span><span class='kw'>=</span><span class='no'>poped.db</span>$<span class='no'>design</span>$<span class='no'>groupsize</span>,
      <span class='kw'>ni</span><span class='kw'>=</span><span class='no'>poped.db</span>$<span class='no'>design</span>$<span class='no'>ni</span>,
      <span class='kw'>xt</span><span class='kw'>=</span><span class='no'>poped.db</span>$<span class='no'>design</span>$<span class='no'>xt</span>,
      <span class='kw'>x</span><span class='kw'>=</span><span class='no'>poped.db</span>$<span class='no'>design</span>$<span class='no'>x</span>,
      <span class='kw'>a</span><span class='kw'>=</span><span class='no'>poped.db</span>$<span class='no'>design</span>$<span class='no'>a</span>,
      <span class='kw'>bpop</span><span class='kw'>=</span><span class='no'>poped.db</span>$<span class='no'>parameters</span>$<span class='no'>param.pt.val</span>$<span class='no'>bpop</span>,
      <span class='kw'>d</span><span class='kw'>=</span><span class='no'>poped.db</span>$<span class='no'>parameters</span>$<span class='no'>param.pt.val</span>$<span class='no'>d</span>,
      <span class='kw'>sigma</span><span class='kw'>=</span><span class='no'>poped.db</span>$<span class='no'>parameters</span>$<span class='no'>sigma</span>,
      <span class='kw'>docc</span><span class='kw'>=</span><span class='no'>poped.db</span>$<span class='no'>parameters</span>$<span class='no'>param.pt.val</span>$<span class='no'>docc</span>,
      <span class='no'>poped.db</span>)[<span class='st'>"ret"</span>]</div><div class='output co'>#&gt; $ret
#&gt;             [,1]      [,2]      [,3]         [,4]         [,5]        [,6]
#&gt; [1,] 17141.83891 20.838375 10.011000 0.000000e+00     0.000000  0.00000000
#&gt; [2,]    20.83837 17.268051 -3.423641 0.000000e+00     0.000000  0.00000000
#&gt; [3,]    10.01100 -3.423641 49.864697 0.000000e+00     0.000000  0.00000000
#&gt; [4,]     0.00000  0.000000  0.000000 2.324341e+03     9.770352  0.03523364
#&gt; [5,]     0.00000  0.000000  0.000000 9.770352e+00 19083.877564 11.72131703
#&gt; [6,]     0.00000  0.000000  0.000000 3.523364e-02    11.721317 38.85137516
#&gt; [7,]     0.00000  0.000000  0.000000 1.453682e+02  1931.231711 12.95619110
#&gt; [8,]     0.00000  0.000000  0.000000 9.062739e+01   266.487127  2.94728469
#&gt;            [,7]        [,8]
#&gt; [1,]    0.00000    0.000000
#&gt; [2,]    0.00000    0.000000
#&gt; [3,]    0.00000    0.000000
#&gt; [4,]  145.36819   90.627386
#&gt; [5,] 1931.23171  266.487127
#&gt; [6,]   12.95619    2.947285
#&gt; [7,] 7713.60804 1331.913973
#&gt; [8,] 1331.91397  475.500111
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://katalog.uu.se/empinfo/?languageId=1&id=N4-631'>Andrew C. Hooker</a>, Sebastian Ueckert, Marco Foracchia, Joakim Nyberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
