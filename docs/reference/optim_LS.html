<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Optimization Using a Line Search Algorithm. — optim_LS • PopED</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">PopED</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/intro-poped.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/andrewhooker/PopED">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Optimization Using a Line Search Algorithm.</h1>
    </div>

    
    <p><code>optim_LS</code> performs sequential grid search optimization of an arbitrary function with respect 
to each of the parameters to be optimized over. 
The function works for both discrete and continuous optimization parameters 
and allows for box-constraints (by using the upper and lower function arguments) or sets of allowed values (by using the 
allowed_values function argument) for all parameters, or on a parameter per parameter basis.</p>
    

    <pre><span class='fu'>optim_LS</span>(<span class='no'>par</span>, <span class='no'>fn</span>, <span class='kw'>lower</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>upper</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>allowed_values</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>50</span>, <span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>maximize</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='no'>F</span>,
  <span class='kw'>parallel_type</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>num_cores</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fu'>round</span>(<span class='fu'>runif</span>(<span class='fl'>1</span>, <span class='fl'>0</span>,
  <span class='fl'>1e+07</span>)), <span class='kw'>replicates_index</span> <span class='kw'>=</span> <span class='fu'>seq</span>(<span class='fl'>1</span>, <span class='fu'>length</span>(<span class='no'>par</span>)), <span class='kw'>ofv_initial</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>closed_bounds</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>par</dt>
      <dd>A vector of initial values for the parameters to be optimized over.</dd>
      <dt>fn</dt>
      <dd>A function to be minimized (or maximized), 
with first argument the vector of parameters over which minimization is to take place. 
It should return a scalar result.</dd>
      <dt>lower</dt>
      <dd>Lower bounds on the parameters. A vector.</dd>
      <dt>upper</dt>
      <dd>Upper bounds on the parameters. A vector.</dd>
      <dt>allowed_values</dt>
      <dd>A list containing allowed values for each parameter <code>list(par1=c(2,3,4,5,6),par2=c(5,6,7,8))</code>. 
A vector containing allowed values for all parameters is also allowed <code>c(2,3,4,5,6)</code>.</dd>
      <dt>line_length</dt>
      <dd>The number of different parameter values per parameter to evaluate.  The values are 
selected as an evenly spaced grid between the upper and lower bounds.</dd>
      <dt>trace</dt>
      <dd>Should the algorithm output results intermittently.</dd>
      <dt>maximize</dt>
      <dd>Should the function be maximized?  Default is to minimize.</dd>
      <dt>parallel</dt>
      <dd>Should we use parallelize the computation.</dd>
      <dt>parallel_type</dt>
      <dd>Which type of parallelization should be used? 
Can be &quot;snow&quot; or &quot;multicore&quot;.  &quot;snow&quot;  works on Linux-like systems &amp; Windows. &quot;multicore&quot; works only on 
Linux-like systems.  By default this is chosen for you depending on your operating system. 
See <code><a href='start_parallel.html'>start_parallel</a></code>.</dd>
      <dt>num_cores</dt>
      <dd>The number of cores to use in the parallelization.  By default  is set to the number 
 output from 
<code>parallel::detectCores()</code>. 
See <code><a href='start_parallel.html'>start_parallel</a></code>.</dd>
      <dt>seed</dt>
      <dd>The random seed to use in the algorithm,</dd>
      <dt>replicates_index</dt>
      <dd>A vector, the same length as the parameters.
If two values are the same in this vector then the parameters may not assume the same value in the optimization.</dd>
      <dt>ofv_initial</dt>
      <dd>An initial objective function value (OFV).  If not NULL then the initial design is not evaluated
and the OFV value is assumed to be this number.</dd>
      <dt>closed_bounds</dt>
      <dd>Are the upper and lower limits open (boundaries not allowed) or closed (boundaries allowed) bounds?</dd>
      <dt>...</dt>
      <dd>Additional arguments passed to <code>fn</code> and <code>start_parallel</code>.</dd>
    </dl>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><ol>
<li> M. Foracchia, A.C. Hooker, P. Vicini and A. Ruggeri, &quot;PopED, a software fir optimal 
experimental design in population kinetics&quot;, Computer Methods and Programs in Biomedicine, 74, 2004.
</li>
<li> J. Nyberg, S. Ueckert, E.A. Stroemberg, S. Hennig, M.O. Karlsson and A.C. Hooker, &quot;PopED: An extended, 
parallelized, nonlinear mixed effects models optimal design tool&quot;,  
Computer Methods and Programs in Biomedicine, 108, 2012.
</li>
</ol></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p>Other Optimize: <code><a href='Doptim.html'>Doptim</a></code>,
  <code><a href='LEDoptim.html'>LEDoptim</a></code>, <code><a href='RS_opt_gen.html'>RS_opt_gen</a></code>,
  <code><a href='RS_opt.html'>RS_opt</a></code>, <code><a href='a_line_search.html'>a_line_search</a></code>,
  <code><a href='bfgsb_min.html'>bfgsb_min</a></code>, <code><a href='calc_autofocus.html'>calc_autofocus</a></code>,
  <code><a href='calc_ofv_and_grad.html'>calc_ofv_and_grad</a></code>, <code><a href='mfea.html'>mfea</a></code>,
  <code><a href='optim_ARS.html'>optim_ARS</a></code>, <code><a href='poped_optimize.html'>poped_optimize</a></code>,
  <code><a href='poped_optim.html'>poped_optim</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## "wild" function , global minimum at about -15.81515</span>
<span class='no'>fw</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fl'>10</span>*<span class='fu'>sin</span>(<span class='fl'>0.3</span>*<span class='no'>x</span>)*<span class='fu'>sin</span>(<span class='fl'>1.3</span>*<span class='no'>x</span>^<span class='fl'>2</span>) + <span class='fl'>0.00001</span>*<span class='no'>x</span>^<span class='fl'>4</span> + <span class='fl'>0.2</span>*<span class='no'>x</span>+<span class='fl'>80</span>

<span class='co'># optimization with fewer function evaluations compared to SANN</span>
<span class='no'>res1</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fl'>50</span>, <span class='no'>fw</span>,<span class='kw'>lower</span> <span class='kw'>=</span> -<span class='fl'>50</span>, <span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>50</span>, <span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>10000</span>)</div><div class='output co'>#&gt; 
#&gt;    Initial parameters: 50 
#&gt;    Initial OFV: 159.0012 
#&gt; 
#&gt;    Searching parameter 1 
#&gt;      Changed from 50 to -15.8166 ; OFV = 67.485 
#&gt; 
#&gt;    Elapsed time: 0.305 seconds.
#&gt; 
#&gt;    Final OFV =  67.48502 
#&gt;    Parameters: -15.81658 
#&gt; </div><div class='input'>
<span class='co'># Upper and lower bounds should be considered carefully</span>
<span class='no'>res2</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fl'>50</span>, <span class='no'>fw</span>, <span class='kw'>lower</span><span class='kw'>=</span>-<span class='fl'>Inf</span>,<span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>Inf</span>,<span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>10000</span>)</div><div class='output co'>#&gt; 
#&gt;    Initial parameters: 50 
#&gt;    Initial OFV: 159.0012 
#&gt; 
#&gt;    Searching parameter 1 
#&gt;      Changed from 50 to -5.0055 ; OFV = 69.8766 
#&gt; 
#&gt;    Elapsed time: 0.081 seconds.
#&gt; 
#&gt;    Final OFV =  69.87659 
#&gt;    Parameters: -5.005501 
#&gt; </div><div class='input'>
<span class='co'># Only integer values allowed</span>
<span class='no'>res_int</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fl'>50</span>, <span class='no'>fw</span>, <span class='kw'>allowed_values</span> <span class='kw'>=</span> <span class='fu'>seq</span>(-<span class='fl'>50</span>,<span class='fl'>50</span>,<span class='kw'>by</span><span class='kw'>=</span><span class='fl'>1</span>))</div><div class='output co'>#&gt; 
#&gt;    Initial parameters: 50 
#&gt;    Initial OFV: 159.0012 
#&gt; 
#&gt;    Searching parameter 1 
#&gt;      Changed from 50 to -17 ; OFV = 68.5368 
#&gt; 
#&gt;    Elapsed time: 0.001 seconds.
#&gt; 
#&gt;    Final OFV =  68.53679 
#&gt;    Parameters: -17 
#&gt; </div><div class='input'>
<span class='co'>## Not run: ------------------------------------</span>
<span class='co'>#  </span>
<span class='co'>#   #plot of the function and solutions</span>
<span class='co'>#   require(graphics)</span>
<span class='co'>#   plot(fw, -50, 50, n = 1000, main = "Minimizing 'wild function'")</span>
<span class='co'>#   points(-15.81515, fw(-15.81515), pch = 16, col = "red", cex = 1)</span>
<span class='co'>#   points(res1$par, res1$ofv, pch = 16, col = "green", cex = 1)</span>
<span class='co'>#   points(res_int$par, res_int$ofv, pch = 16, col = "blue", cex = 1)</span>
<span class='co'>## --------------------------------------------- </span>

<span class='co'># Rosenbrock Banana function</span>
<span class='co'># f(x, y) = (a-x)^2 + b*(y-x^2)^2</span>
<span class='co'># global minimum at (x, y)=(a, a^2), where f(x, y)=0. </span>
<span class='co'># Usually a = 1 and b = 100 so x=1 and y=1</span>
<span class='co'>## Not run: ------------------------------------</span>
<span class='co'>#  </span>
<span class='co'>#   fr &lt;- function(x,a=1,b=100) {   </span>
<span class='co'>#     x1 &lt;- x[1]</span>
<span class='co'>#     x2 &lt;- x[2]</span>
<span class='co'>#     b*(x2 - x1*x1)^2 + (a - x1)^2</span>
<span class='co'>#   }</span>
<span class='co'>#   </span>
<span class='co'>#   res3 &lt;- optim_LS(c(-1.2,1), fr,lower = -5, upper = 5, line_length = 1000)</span>
<span class='co'># </span>
<span class='co'>#   # plot the surface</span>
<span class='co'>#   x &lt;- seq(-50, 50, length= 30)</span>
<span class='co'>#   y &lt;- x</span>
<span class='co'>#   f &lt;- function(x,y){apply(cbind(x,y),1,fr)}</span>
<span class='co'>#   z &lt;- outer(x, y, f)</span>
<span class='co'>#   persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue", ticktype="detailed") -&gt; res</span>
<span class='co'>#   points(trans3d(1, 1, 0, pmat = res), col = 2, pch = 16,cex=2)</span>
<span class='co'>#   points(trans3d(res3$par[1], res3$par[1], res3$ofv, pmat = res), col = "green", pch = 16,cex=2)</span>
<span class='co'>## ---------------------------------------------</span>

<span class='co'># box constraints</span>
<span class='no'>flb</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>){
  <span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'>length</span>(<span class='no'>x</span>)
  <span class='fu'>sum</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fu'>rep</span>(<span class='fl'>4</span>, <span class='no'>p</span>-<span class='fl'>1</span>)) * (<span class='no'>x</span> - <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='no'>x</span>[-<span class='no'>p</span>])^<span class='fl'>2</span>)^<span class='fl'>2</span>)
}

<span class='co'>## 25-dimensional box constrained</span>
<span class='co'>## Not run: ------------------------------------</span>
<span class='co'>#  </span>
<span class='co'># optim(rep(3, 25), flb,lower = rep(2, 25), upper = rep(4, 25),method = "L-BFGS-B") </span>
<span class='co'>## ---------------------------------------------</span>
<span class='no'>res_box</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fu'>rep</span>(<span class='fl'>3</span>, <span class='fl'>25</span>), <span class='no'>flb</span>,<span class='kw'>lower</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>2</span>, <span class='fl'>25</span>), <span class='kw'>upper</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>4</span>, <span class='fl'>25</span>),<span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>1000</span>)</div><div class='output co'>#&gt; 
#&gt;    Initial parameters: 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 
#&gt;    Initial OFV: 3460 
#&gt; 
#&gt;    Searching parameter 11 
#&gt;      Changed from 3 to 2.14414 ; OFV = 3370.22 
#&gt;    Searching parameter 18 
#&gt;      Changed from 3 to 2.14414 ; OFV = 3280.43 
#&gt;    Searching parameter 1 
#&gt;      Changed from 3 to 2 ; OFV = 3137.43 
#&gt;    Searching parameter 7 
#&gt;      Changed from 3 to 2.14414 ; OFV = 3047.65 
#&gt;    Searching parameter 23 
#&gt;      Changed from 3 to 2.14414 ; OFV = 2957.87 
#&gt;    Searching parameter 5 
#&gt;      Changed from 3 to 2.14414 ; OFV = 2868.09 
#&gt;    Searching parameter 19 
#&gt;      Changed from 3 to 2 ; OFV = 2744.86 
#&gt;    Searching parameter 16 
#&gt;      Changed from 3 to 2.14414 ; OFV = 2655.08 
#&gt;    Searching parameter 4 
#&gt;      Changed from 3 to 2 ; OFV = 2532.85 
#&gt;    Searching parameter 8 
#&gt;      Changed from 3 to 2 ; OFV = 2409.63 
#&gt;    Searching parameter 24 
#&gt;      Changed from 3 to 2 ; OFV = 2286.41 
#&gt;    Searching parameter 22 
#&gt;      Changed from 3 to 2 ; OFV = 2164.17 
#&gt;    Searching parameter 3 
#&gt;      Changed from 3 to 2 ; OFV = 2036.17 
#&gt;    Searching parameter 2 
#&gt;      Changed from 3 to 2 ; OFV = 1868.17 
#&gt;    Searching parameter 17 
#&gt;      Changed from 3 to 2 ; OFV = 1710.72 
#&gt;    Searching parameter 6 
#&gt;      Changed from 3 to 2 ; OFV = 1553.26 
#&gt;    Searching parameter 9 
#&gt;      Changed from 3 to 2 ; OFV = 1425.26 
#&gt;    Searching parameter 20 
#&gt;      Changed from 3 to 2 ; OFV = 1297.26 
#&gt;    Searching parameter 10 
#&gt;      Changed from 3 to 2 ; OFV = 1135.03 
#&gt;    Searching parameter 21 
#&gt;      Changed from 3 to 2 ; OFV = 967.026 
#&gt;    Searching parameter 14 
#&gt;      Changed from 3 to 2.14414 ; OFV = 877.243 
#&gt;    Searching parameter 13 
#&gt;      Changed from 3 to 2 ; OFV = 755.009 
#&gt;    Searching parameter 25 
#&gt;      Changed from 3 to 4 ; OFV = 751.009 
#&gt;    Searching parameter 12 
#&gt;      Changed from 3 to 2 ; OFV = 587.788 
#&gt;    Searching parameter 15 
#&gt;      Changed from 3 to 2 ; OFV = 430.333 
#&gt; 
#&gt;    Elapsed time: 0.258 seconds.
#&gt; 
#&gt;    Final OFV =  430.3326 
#&gt;    Parameters: 2 2 2 2 2.144144 2 2.144144 2 2 2 2.144144 2 2 2.144144 2 2.144144 2 2.144144 2 2 2 2 2.144144 2 4 
#&gt; </div><div class='input'>
<span class='co'># one-dimensional function</span>
<span class='co'>## Not run: ------------------------------------</span>
<span class='co'>#  </span>
<span class='co'>#   f &lt;- function(x)  abs(x)+cos(x)</span>
<span class='co'>#   res5 &lt;- optim_LS(-20,f,lower=-20, upper=20, line_length = 500)</span>
<span class='co'>#   </span>
<span class='co'>#   curve(f, -20, 20)</span>
<span class='co'>#   abline(v = res5$par, lty = 4,col="green")</span>
<span class='co'>## ---------------------------------------------  </span>

<span class='co'># one-dimensional function</span>
<span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>)  (<span class='no'>x</span>^<span class='fl'>2</span>+<span class='no'>x</span>)*<span class='fu'>cos</span>(<span class='no'>x</span>) <span class='co'># -10 &lt; x &lt; 10</span>
<span class='no'>res_max</span> <span class='kw'>&lt;-</span> <span class='fu'>optim_LS</span>(<span class='fl'>0</span>,<span class='no'>f</span>,<span class='kw'>lower</span><span class='kw'>=</span>-<span class='fl'>10</span>, <span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>10</span>,<span class='kw'>maximize</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>line_length</span> <span class='kw'>=</span> <span class='fl'>1000</span>)</div><div class='output co'>#&gt; 
#&gt;    Initial parameters: 0 
#&gt;    Initial OFV: 0 
#&gt; 
#&gt;    Searching parameter 1 
#&gt;      Changed from 0 to 6.55656 ; OFV = 47.7052 
#&gt; 
#&gt;    Elapsed time: 0.004 seconds.
#&gt; 
#&gt;    Final OFV =  47.7052 
#&gt;    Parameters: 6.556557 
#&gt; </div><div class='input'>
<span class='co'>## Not run: ------------------------------------</span>
<span class='co'>#  </span>
<span class='co'>#   res_min &lt;- optim_LS(0,f,lower=-10, upper=10, line_length = 1000) </span>
<span class='co'>#   </span>
<span class='co'>#   curve(f, -10, 10)</span>
<span class='co'>#   abline(v = res_min$par, lty = 4,col="green")</span>
<span class='co'>#   abline(v = res_max$par, lty = 4,col="red")</span>
<span class='co'>## ---------------------------------------------</span>


<span class='co'># two-dimensional Rastrigin function</span>
<span class='co'>#It has a global minimum at f(x) = f(0) = 0.</span>
<span class='co'>## Not run: ------------------------------------</span>
<span class='co'>#  </span>
<span class='co'>#   Rastrigin &lt;- function(x1, x2){</span>
<span class='co'>#     20 + x1^2 + x2^2 - 10*(cos(2*pi*x1) + cos(2*pi*x2))</span>
<span class='co'>#   }</span>
<span class='co'>#   </span>
<span class='co'>#   </span>
<span class='co'>#   x1 &lt;- x2 &lt;- seq(-5.12, 5.12, by = 0.1)</span>
<span class='co'>#   z &lt;- outer(x1, x2, Rastrigin)</span>
<span class='co'>#   </span>
<span class='co'>#   res6 &lt;- optim_LS(c(-4,4),function(x) Rastrigin(x[1], x[2]),</span>
<span class='co'>#                    lower=-5.12, upper=5.12, line_length = 1000)</span>
<span class='co'>#   </span>
<span class='co'>#   # color scale</span>
<span class='co'>#   nrz &lt;- nrow(z)</span>
<span class='co'>#   ncz &lt;- ncol(z)</span>
<span class='co'>#   jet.colors &lt;-</span>
<span class='co'>#     colorRampPalette(c("#00007F", "blue", "#007FFF", "cyan",</span>
<span class='co'>#                        "#7FFF7F", "yellow", "#FF7F00", "red", "#7F0000"))</span>
<span class='co'>#   # Generate the desired number of colors from this palette</span>
<span class='co'>#   nbcol &lt;- 100</span>
<span class='co'>#   color &lt;- jet.colors(nbcol)</span>
<span class='co'>#   # Compute the z-value at the facet centres</span>
<span class='co'>#   zfacet &lt;- z[-1, -1] + z[-1, -ncz] + z[-nrz, -1] + z[-nrz, -ncz]</span>
<span class='co'>#   # Recode facet z-values into color indices</span>
<span class='co'>#   facetcol &lt;- cut(zfacet, nbcol)</span>
<span class='co'>#   persp(x1, x2, z, col = color[facetcol], phi = 30, theta = 30)</span>
<span class='co'>#   filled.contour(x1, x2, z, color.palette = jet.colors)</span>
<span class='co'>## ---------------------------------------------</span>


<span class='co'>## Parallel computation  </span>
<span class='co'>## works better when each evaluation takes longer</span>
<span class='co'>## here we have added extra time to the computations</span>
<span class='co'>## just to show that it works</span>
<span class='co'>## Not run: ------------------------------------</span>
<span class='co'>#  </span>
<span class='co'>#   res7 &lt;- optim_LS(c(-4,4),function(x){Sys.sleep(0.01); Rastrigin(x[1], x[2])},</span>
<span class='co'>#                    lower=-5.12, upper=5.12, line_length = 200)</span>
<span class='co'>#   res8 &lt;- optim_LS(c(-4,4),function(x){Sys.sleep(0.01); Rastrigin(x[1], x[2])},</span>
<span class='co'>#                    lower=-5.12, upper=5.12, line_length = 200, parallel = TRUE)</span>
<span class='co'>#   res9 &lt;- optim_LS(c(-4,4),function(x){Sys.sleep(0.01); Rastrigin(x[1], x[2])},</span>
<span class='co'>#                    lower=-5.12, upper=5.12, line_length = 200, parallel = TRUE, </span>
<span class='co'>#                    parallel_type = "snow")</span>
<span class='co'>## ---------------------------------------------</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://katalog.uu.se/empinfo/?languageId=1&id=N4-631'>Andrew C. Hooker</a>, Sebastian Ueckert, Marco Foracchia, Joakim Nyberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
